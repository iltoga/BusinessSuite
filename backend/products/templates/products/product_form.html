{% extends "base_template.html" %}
{% load static %}
{% load crispy_forms_tags %}
{% load widget_tweaks %}

{% block title %}BusinessSuite - products{% endblock %}

<!-- Add extra jquery components for this form -->
{% block head-after-jquery-js %}
    {{ block.super }}
    <link rel="stylesheet" type="text/css" href="{% static 'plugins/tags-input/tagsinput.css' %}" />
    <script src="{% static 'plugins/tags-input/tagsinput.js' %}"></script>
    <style>
        .sortable-item.drag-over {
            border-top: 2px solid #0d6efd;
        }
        .sortable-item.selected-item:hover {
            background-color: rgba(13, 110, 253, 0.2) !important;
        }
        .sortable-item.available-item:hover {
            background-color: rgba(0, 0, 0, 0.1) !important;
        }
        .sortable-selected {
            background-color: rgba(13, 110, 253, 0.05);
        }
    </style>
{% endblock %}

{% block content %}
<div>
    <h2 class="text-center my-4">{{ action_name }} a new product</h2>
    <form method="post" class="p-3 rounded w-100" action="" id="product-form" novalidate>
        {% csrf_token %}
        {{ form | crispy }}
        {{ tasks.management_form }}
        <div id="task-form-list">
            {% for task_form in tasks %}
            <div class="task-form p-3 mb-4 border rounded">
                {{ task_form | crispy }}
                <button type="button" class="btn btn-danger remove-task-btn mt-2">Remove Task</button>
            </div>
            {% endfor %}
        </div>

        <!-- Template for a new task form (hidden) -->
        <div id="empty-form" style="display:none;">
            <div class="task-form p-3 mb-4 border rounded">
                {{ tasks.empty_form | crispy }}
                <button type="button" class="btn btn-danger remove-task-btn mt-2">Remove Task</button>
            </div>
        </div>

        <div>
            <hr />
            <button type="button" class="btn btn-primary" id="add-task">Add Task</button>
            <button type="submit" class="btn btn-primary">{{ action_name }}</button>
            <a href="javascript:history.back()" class="btn btn-outline-primary">Back</a>
        </div>
    </form>
</div>
{% endblock %}

{% block after-bootstrap-js %}
    {{ block.super }}
    <script src="{% static 'js/products/product_form.js' %}"></script>
{% endblock %}