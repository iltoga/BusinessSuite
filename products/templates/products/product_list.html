{% extends "base_template.html" %}
{% load static %}

{% block content %}
<div class="centered-content">
  <h2>Product List</h2>

  <div class="col", style="margin-bottom: 10px;padding: 10px;">
    <!-- Search form -->
    <form method="get" style="margin-right: 20px;">
      <input type="text" name="q" placeholder="Search products">
      <input type="submit" value="Search">
    </form>
    <a href="{% url 'product-create' %}" class="btn btn-primary">New product</a>
  </div>

<div class="centered-content">

  {% if products %}
  <table class="table table-striped table-bordered">
    <thead class="thead-light">
      <tr>
        <th scope="col">Name</th>
        <th scope="col">Code</th>
        <th scope="col">Product Type</th>
        <th scope="col">Actions</th>
      </tr>
    </thead>
    <tbody>
      {% for product in products %}
      <tr>
        <td>{{ product.name }}</td>
        <td>{{ product.code }}</td>
        <td>{{ product.get_product_type_display }}</td>
        <td>
          <a href="{% url 'product-detail' product.id %}" class="btn btn-primary btn-sm">View</a>
          {% if perms.products.change_product %}
          <a href="{% url 'product-update' product.id %}" class="btn btn-warning btn-sm">Edit</a>
          {% endif %}
          {% if perms.products.delete_product %}
          <a href="{% url 'product-delete' product.id %}" class="btn btn-danger btn-sm">Delete</a>
          {% endif %}
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>

  <div class="pagination">
    <span class="step-links">
        {% if products.has_previous %}
            <a href="?page=1">&laquo; first</a>
            <a href="?page={{ products.previous_page_number }}">previous</a>
        {% endif %}

        <span class="current">
            {% if products.paginator.count > 0 %}
                Page {{ products.number }} of {{ products.paginator.num_pages }}.
            {% else %}
                <!-- No pages to display. -->
            {% endif %}
        </span>

        {% if products.has_next %}
            <a href="?page={{ products.next_page_number }}">next</a>
            <a href="?page={{ products.paginator.num_pages }}">last &raquo;</a>
        {% endif %}
    </span>
  </div>

  {% else %}
  <p>No products found.</p>
  {% endif %}
</div>
{% endblock %}
