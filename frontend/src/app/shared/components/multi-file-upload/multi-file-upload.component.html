<div class="space-y-3">
  <!-- Drop zone -->
  <div
    [class]="
      'flex flex-col items-center justify-center gap-1 rounded-lg border-2 border-dashed p-6 transition-colors cursor-pointer ' +
      (isDragging()
        ? 'border-primary bg-primary/5'
        : 'border-muted-foreground/25 hover:border-primary/50 hover:bg-muted/30') +
      (disabled() ? ' opacity-50 cursor-not-allowed' : '')
    "
    (click)="onBrowseClick()"
    (drop)="onDrop($event)"
    (dragover)="onDragOver($event)"
    (dragleave)="onDragLeave($event)"
  >
    <input
      #fileInput
      type="file"
      class="hidden"
      [accept]="accept()"
      [disabled]="disabled()"
      [multiple]="true"
      (change)="onFileChange($event)"
    />
    <div class="text-2xl">üìÅ</div>
    <div class="text-sm font-medium">{{ label() }}</div>
    <div class="text-xs text-muted-foreground text-center">{{ helperText() }}</div>
  </div>

  <!-- File list -->
  @if (hasFiles()) {
    <div class="rounded-md border bg-card">
      <div class="flex items-center justify-between border-b px-3 py-2">
        <span class="text-sm font-medium">
          {{ fileCount() }} file(s) selected ({{ totalSize() }})
        </span>
        <button type="button" z-button zType="ghost" zSize="sm" (click)="clearAll()">
          Clear all
        </button>
      </div>
      <ul class="divide-y">
        @for (sf of selectedFiles(); track sf.name; let i = $index) {
          <li class="flex items-center justify-between px-3 py-2 text-sm hover:bg-muted/30">
            <div class="flex items-center gap-2 min-w-0 flex-1">
              <span class="shrink-0">{{ getFileIcon(sf.type) }}</span>
              <span class="truncate">{{ sf.name }}</span>
              <span class="text-xs text-muted-foreground shrink-0">{{ formatSize(sf.size) }}</span>
            </div>
            <button
              type="button"
              z-button
              zType="ghost"
              zSize="sm"
              class="shrink-0 ml-2 text-destructive hover:text-destructive"
              (click)="removeFile(i); $event.stopPropagation()"
            >
              ‚úï
            </button>
          </li>
        }
      </ul>
    </div>
  }
</div>
